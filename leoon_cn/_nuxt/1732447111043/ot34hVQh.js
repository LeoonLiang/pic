import{E as S,a as C}from"./DJ0UmOdH.js";import"./GztLCBww.js";import{d as k,ac as b,o as s,c as a,b as n,V as u,f as h,M as L,ab as $,e as r,h as I,u as B,r as w,y as V,R as v,a as g,S as E}from"./DQjMOqax.js";import{u as N,a as P}from"./dc5OHkd4.js";import{_ as M}from"./CuzBXUAD.js";import{O as y}from"./TbSGmeC1.js";const O=(e,t)=>`https://cdn.tsinbei.com/gh/LeoonLiang/pic@main/tuchong/image-${e}.${t?"webp":"jpg"}`,T=k({name:"PictureWall",props:{imageList:{type:Array,default:""},title:{type:String,default:""},desc:{type:String,default:""},favorites:{type:Number,default:0},postId:{type:String,default:""}},data(){return{originList:[],curIndex:0,showViewer:!1}},methods:{handlePopstate(e){this.showViewer&&y.close()},viewImage(e){y.show(this.imageList.map(t=>{var i;return{src:O(t.img_id.toString(),this.$supportsAvif.value),thumb:(i=t.source)==null?void 0:i.mr.replace("/mr/","/t/"),type:"image"}}),{Toolbar:!1,startIndex:e,showClass:!1,hideClass:!1,on:{ready:()=>{history.pushState({popup:!0},""),window.addEventListener("popstate",this.handlePopstate),this.showViewer=!0},close:()=>{this.showViewer=!1,history.state&&history.state.popup&&history.back(),window.removeEventListener("popstate",this.handlePopstate)}}})}}}),q={class:"leoon-picture-wall"},A={class:"leoon-picture-wall-info"},D=["href"],R={key:1,class:"leoon-picture-wall-excerpt"},W={key:2,class:"leoon-picture-wall-addition"},j={class:"leoon-picture-wall-img"},F={class:"leoon-picture-wall-img-wrapper"},H={key:0,class:"leoon-picture-wall-img-wrapper nine"};function J(e,t,i,p,f,c){var l;const m=M;return s(),a("div",q,[n("div",A,[e.title?(s(),a("a",{key:0,class:"leoon-picture-wall-title",href:`/posts/${e.postId}`,target:"_blank"},u(e.title),9,D)):h("",!0),e.desc?(s(),a("div",R,u(e.desc),1)):h("",!0),e.favorites?(s(),a("div",W," 喜欢 "+u(e.favorites),1)):h("",!0)]),n("div",j,[(s(!0),a(L,null,$(e.imageList.slice(0,8),(d,o)=>{var _;return s(),a("div",F,[r(m,{onClick:U=>e.viewImage(o),src:(_=d.source)==null?void 0:_.mr,ratio:"1",fit:"cover"},null,8,["onClick","src"])])}),256)),e.imageList.length>8?(s(),a("div",H,[r(m,{src:(l=e.imageList[8].source)==null?void 0:l.mr,ratio:"1",fit:"cover"},null,8,["src"]),n("div",{onClick:t[0]||(t[0]=d=>e.viewImage(8)),class:"img-number-mask"}," +"+u(e.imageList.length-8),1)])):h("",!0)])])}const x=b(T,[["render",J]]),z={class:"post-wrapper",style:{width:"1086px"}},G={class:"leoon-picture-wall"},K={class:"leoon-picture-wall-info"},Q={class:"leoon-picture-wall-img"},oe=k({__name:"index",setup(e){const t=I();B({title:"摄影 - Leoon Liang - Blog",ogTitle:"摄影 - Leoon Liang - Blog"});const i=w([]),p=w(!0),f=async()=>{try{const{data:c}=await $fetch("/api/tc",{params:t.query,headers:{...N(t.query)}});c&&(i.value=JSON.parse(P(c)).post_list)}catch{}finally{p.value=!1}};return V(()=>{f()}),(c,m)=>{const l=C,d=S;return s(),a("div",z,[r(d,{loading:g(p)&&g(i).length===0,animated:"",count:3,throttle:60},{template:v(()=>[n("div",G,[n("div",K,[r(l,{variant:"h1",class:"leoon-picture-wall-title",style:{width:"70%"}}),r(l,{variant:"h3",class:"leoon-picture-wall-excerpt",style:{width:"50%"}}),r(l,{variant:"text",class:"leoon-picture-wall-addition",style:{width:"20%"}})]),n("div",Q,[r(l,{variant:"image",style:{width:"100%"}})])])]),default:v(()=>[(s(!0),a(L,null,$(g(i),o=>(s(),E(x,{key:o.post_id,"image-list":o.images,title:o.title,desc:o.excerpt,favorites:o.favorites,styles:o.styles,"post-id":o.post_id},null,8,["image-list","title","desc","favorites","styles","post-id"]))),128))]),_:1},8,["loading"])])}}});export{oe as default};
